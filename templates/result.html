<!-- templates/result.html -->
<!DOCTYPE html>
<html>
  <head>
    <title>Flask File Upload Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <div class="container mt-3">
      <h1>Upload File Result</h1>
      <p>{{ filename }} 파일 패킷 분석 결과입니다.</p>
      <p>총 패킷: {{ data['total_pks'] }}개</p>
      <p>멀웨어 파일: {{ data['detect']|length }}개</p>
      <p>멀웨어 의심 파일: {{ data['suspect']|length }}개</p>

      <table class="table table-hover">
        <thead>
          <th>파일명</th>
          <th>파일 매직 넘버</th>
          <th>결과</th>
          <th>비고</th>
        </thead>
        <tbody>
          {% for k in data['detect'] %}
          <tr>
            <td>{{ k }}</td>
            <td>{{ data['detect'][k] }}</td>
            <td class="text-danger"><b>멀웨어 파일</b></td>
            <td><a href="#">상세정보</a></td>
          </tr>
          {% endfor %}
          {% for k in data['suspect'] %}
          <tr>
            <td>{{ k }}</td>
            <td>-</td>
            <td class="text-warning"><b>멀웨어 의심 파일</b></td>
            <td><a href="#">상세정보</a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <a href="/" type="button" class="btn btn-danger">back</a>

    </div>
  </body>
</html>